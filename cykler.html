<!DOCTYPE html>
<html lang="DA">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

    <nav>
        Menu: <a href="index.html">Forside</a> <a href="kontakt.html">Kontakt</a> <a href="omos.html">Om Os</a>
    </nav>
    <nav class="menu">
        <button data-kategori="alle" class="valgt">Alle</button>
        <button data-kategori="Bycykel">Bycykler</button>
        <button data-kategori="Elcykel">Elcykler</button>
        <button data-kategori="Racercykel">Racercykler</button>
        <button data-kategori="Trekking">Trekking</button>
    </nav>

    <h1></h1>

    <template>
        <article>
            <img class="cykler_image" src="" alt="">
            <h2></h2>
            <p></p>

        </article>
    </template>
    <h1></h1>
    <main>
        <section id="liste"></section>
    </main>

    <script>
        let retter = [];
        const filterKnapper = document.querySelectorAll("button");
        let filter = "alle";
        document.addEventListener("DOMContentLoaded", start);

        function start() {
            hentJson();
        }

        async function hentJson() {
            const url = "http://beansprout.dk/kea/2.semester/tema9/Koga/wordpress/wp-json/wp/v2/Cykel";
            let myJson = await fetch(url);

            retter = await myJson.json();
            visIndhold();
            console.log(retter);
        }

        filterKnapper.forEach(knap => knap.addEventListener("click", filtrer));

        function filtrer() {

            //filter sættes til teksten fra den knap der blev trykket på
            filter = this.dataset.kategori;
            //overskriften ændres til at sige hvordan der filtreres
            //document.querySelector(".overskrift_kategori").textContent = `${this.textContent} Cocktails`;
            //den highlightede knap flyttes til den nye aktive kategori
            filterKnapper.forEach(knap => knap.classList.remove("valgt"));
            this.classList.add("valgt");
            visIndhold();
        }

        function visIndhold() {
            liste.innerHTML = "";
            retter.forEach(ret => {
                console.log(ret.kategorier[0]);
                if (ret.kategorier[0] == filter || filter == "alle") {

                    const klon = document.querySelector("template").cloneNode(true).content;

                    klon.querySelector("img").src = ret.billede_hele_cyklen_1.guid;
                    klon.querySelector("h2").textContent = ret.title.rendered;
                    klon.querySelector("p").innerHTML = ret.kort_beskrivelse;
                    document.querySelector("section").appendChild(klon);

                    document.querySelector("section").lastElementChild.addEventListener("click", () => {
                        location.href = `detail.html?id=${ret.id}`;
                    });
                }
            })
        }

    </script>
</body>

</html>
